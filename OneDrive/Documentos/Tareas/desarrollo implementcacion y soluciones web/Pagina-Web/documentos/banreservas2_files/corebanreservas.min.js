
$(document).ready(function () {
  
    $(window).resize(function () {
        if ($(window).width() > 980) {
            $(".site-footer-panel .list-menu").addClass("show");
            $(".site-footer-panel .title").removeAttr("data-toggle");
        } else {
            $(".site-footer-panel .list-menu").removeClass("show");
            $(".site-footer-panel .title").attr("data-toggle", "collapse");
        }
    });
});

$(".txt-busqueda").keypress(function (e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) {
        e.preventDefault();
        if ($(this).val() != '') {
            window.localStorage.setItem('searchText', $(this).val());
            window.location.replace('/buscar')
        }
    }
})


function obtenerFecha(fecha) {
    date = new Date(fecha);
    year = date.getFullYear();
    month = date.getMonth() + 1;
    dt = date.getDate();
    if (dt < 10) {
        dt = "0" + dt;
    }
    if (month < 10) {
        month = "0" + month;
    }
    return dt + "/" + month + "/" + year;
}
function obtenerAnio(fecha) {
    date = new Date(fecha);
    year = date.getFullYear();
    return year;
}

function obtenerMes(fecha) {
    date = new Date(fecha);
    month = date.getMonth() + 1;
    if (month < 10) {
        month = "0" + month;
    }
    return month;
}

function nombreMes(fecha) {
    date = new Date(fecha);
    month = date.getMonth() + 1;
    switch (month) {
        case 1:
            return "Enero";
        case 2:
            return "Febrero";
        case 3:
            return "Marzo";
        case 4:
            return "Abril";
        case 5:
            return "Mayo";
        case 6:
            return "Junio";
        case 7:
            return "Julio";
        case 8:
            return "Agosto";
        case 9:
            return "Septiembre";
        case 10:
            return "Octubre";
        case 11:
            return "Noviembre";
        case 12:
            return "Diciembre";
    }
}


$(document).ready(function () {
    // Main carousel control
    $(".main_container_banner .owl-carousel").owlCarousel({
        items: 1,
        merge: !0,
        loop: !0,
        margin: 0,
        video: !0,
        lazyLoad: !1,
        autoplay: !0,
        autoplayTimeout: 5000,
        autoplayHoverPause: !0,
        nav: !0,
        center: !0,
        videoHeight: !0,
        onTranslate: function (event) {
            var currentSlide, player;
            currentSlide = $(".main_container_banner .owl-item.active");
            player = currentSlide.find("iframe").get(0);
            if (player != undefined) {
                currentSlide.find("iframe").remove();
            }
        },
    });
    $(".main_container_banner .owl-dots").insertAfter(".main_container_banner .owl-prev");
    
    setTimeout(function () {
        $(".almaChat").on("click", function (event) {
            event.preventDefault();
            AlanChat.open();
        });
    }, 3000);
    setTimeout(function () {
        $("a[href*='banreservas.com.do/system/templates/chat']").on("click", function (event) {
            event.preventDefault();
            AlanChat.open();
        });
    }, 500);
});

$(document).on('click', '.social-share', function () {
    var url = $(this).attr('data-url');
    if ($(this).attr('data-social') == 'fb') {
        window.open('https://www.facebook.com/sharer.php?u=' + url, "popupWindow", "width=600,height=600,scrollbars=yes")
    }
    if ($(this).attr('data-social') == 'tw') {
        window.open('https://twitter.com/intent/tweet?original_referer=' + url, "popupWindow", "width=600,height=600,scrollbars=yes")
    }
    if ($(this).attr('data-social') == 'ml') {
        window.open('mailto:?subject=Comparto contigo este contenido de banreservas&body=' + url, "popupWindow", "width=600,height=600,scrollbars=yes")
    }
});

function errorIcon() {
    setTimeout(() => {
        document.querySelectorAll('.field-validation-error').forEach(function (label) {
            label.classList.add('error');
        });
    }, 100);
}
function getDropdownQueryValue() {
    const urlParams = new URLSearchParams(window.location.search);

    const productoValue = urlParams.get('producto');

    if (productoValue) {
        document.getElementById('Producto').value = productoValue;
    }
}

document.addEventListener("DOMContentLoaded", function () {
    getDropdownQueryValue();
});

function cambiarPlaceholder(input, nuevoPlaceholder) {
    let placeholderOriginal = input.getAttribute('placeholder');

    input.addEventListener('mouseenter', function () {
        input.setAttribute('placeholder', nuevoPlaceholder);
    });

    input.addEventListener('mouseleave', function () {
        input.setAttribute('placeholder', placeholderOriginal);
    });
}

document.addEventListener('DOMContentLoaded', function () {
    let telefono = document.getElementById('Telefono');
    let telefono2 = document.getElementById('Telefono2');
    let identidad = document.getElementById('Identidad');

    if (telefono) {
        cambiarPlaceholder(telefono, '(___) ___-____');
    }

    if (telefono2) {
        cambiarPlaceholder(telefono2, '(___) ___-____');
    }

    if (identidad) {
        cambiarPlaceholder(identidad, '___-_______-_');
    }
});

function aplicarMascara(input, mascara) {
    input.addEventListener('input', function (event) {
        let valor = input.value.replace(/\D/g, '');
        let valorFormateado = '';

        for (let i = 0, j = 0; i < mascara.length && j < valor.length; i++) {
            if (mascara[i] === '_') {
                valorFormateado += valor[j++];
            } else {
                valorFormateado += mascara[i];
            }
        }

        input.value = valorFormateado;
    });
    input.addEventListener('focus', function () {
        if (input.value === '') {
            input.value = mascara;
        }
    });

    input.addEventListener('blur', function () {
        if (input.value === mascara) {
            input.value = '';
        }
    });
}

document.addEventListener('DOMContentLoaded', function () {
    let telefono = document.getElementById('Telefono');
    let telefono2 = document.getElementById('Telefono2');
    let identidad = document.getElementById('Identidad');

    if (telefono) {
        aplicarMascara(telefono, '(___)___-____');
    }

    if (telefono2) {
        aplicarMascara(telefono2, '(___)___-____');
    }

    if (identidad) {
        aplicarMascara(identidad, '___-_______-_');
    }
});

// Inicio de formulario para Google Tag Manager
document.addEventListener("focusin", function(e) {
    const form = e.target.closest("form");
    if (form && !form.dataset.formStarted) {

        form.dataset.formStarted = "true"; // evita disparos múltiples
        dataLayer.push({
            event: "form_start",
            form_id: form.id || null,
            form_name: form.getAttribute("name") || null        });
    }
});